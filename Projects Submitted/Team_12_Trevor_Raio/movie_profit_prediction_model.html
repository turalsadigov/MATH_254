<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.649">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Trevor Wilkes">
<meta name="author" content="Raio Huang">
<meta name="author" content="Tural Sadigov">
<meta name="dcterms.date" content="2022-10-17">

<title>Movie Profit Prediction Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="movie_profit_prediction_model_files/libs/clipboard/clipboard.min.js"></script>
<script src="movie_profit_prediction_model_files/libs/quarto-html/quarto.js"></script>
<script src="movie_profit_prediction_model_files/libs/quarto-html/popper.min.js"></script>
<script src="movie_profit_prediction_model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="movie_profit_prediction_model_files/libs/quarto-html/anchor.min.js"></script>
<link href="movie_profit_prediction_model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="movie_profit_prediction_model_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="movie_profit_prediction_model_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="movie_profit_prediction_model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="movie_profit_prediction_model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="movie_profit_prediction_model_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme">
<link href="movie_profit_prediction_model_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate">
<style>
    .quarto-title-block .quarto-title-banner {
      background: lightblue;
    }
    </style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Movie Profit Prediction Model</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      Trevor Wilkes 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Hamilton College
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      Raio Huang 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Hamilton College
            </p>
        </div>
        <div class="quarto-title-meta-contents">
      Tural Sadigov 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Hamilton College
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 17, 2022</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Abstract</div>
      The film industry is constantly looking at what makes a movie work, what makes it successful in a modern market. This includes looking at a number of factors, including the budgets of past films or their audience ratings, for example. In this paper we use machine learning methods, specifically multiple linear regression, bootstrapping, and feature engineering on the IMDB 5000 Movies dataset obtained from Kaggle to discover the influence of multiple factors on movie gross income. We found that some genres, such as comedy and family, are more likely to contribute to the gross income, while others decrease profitability. Finally, we found that the variables such as IMDB scores, budget of a movie, duration of a movie, and number of votes it got on IMDB, can be used as predictors for film gross.
    </div>
  </div>
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background-and-significance" id="toc-background-and-significance" class="nav-link active" data-scroll-target="#background-and-significance"> <span class="header-section-number">1</span> Background and Significance</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"> <span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection"> <span class="header-section-number">2.1</span> Data Collection</a></li>
  <li><a href="#variable-creation" id="toc-variable-creation" class="nav-link" data-scroll-target="#variable-creation"> <span class="header-section-number">2.2</span> Variable Creation</a></li>
  <li><a href="#analytic-methods" id="toc-analytic-methods" class="nav-link" data-scroll-target="#analytic-methods"> <span class="header-section-number">2.3</span> Analytic Methods</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"> <span class="header-section-number">3</span> Results</a></li>
  <li><a href="#discussionconclusions" id="toc-discussionconclusions" class="nav-link" data-scroll-target="#discussionconclusions"> <span class="header-section-number">4</span> Discussion/Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"> <span class="header-section-number">5</span> References:</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"> <span class="header-section-number">6</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"> <span class="header-section-number">6.1</span> Libraries</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"> <span class="header-section-number">6.2</span> Dataset</a></li>
  <li><a href="#table-of-variables-in-dataset" id="toc-table-of-variables-in-dataset" class="nav-link" data-scroll-target="#table-of-variables-in-dataset"> <span class="header-section-number">6.3</span> Table of Variables in Dataset</a></li>
  <li><a href="#cleaning" id="toc-cleaning" class="nav-link" data-scroll-target="#cleaning"> <span class="header-section-number">6.4</span> Cleaning</a></li>
  <li><a href="#preliminary-visualizations" id="toc-preliminary-visualizations" class="nav-link" data-scroll-target="#preliminary-visualizations"> <span class="header-section-number">6.5</span> Preliminary Visualizations</a></li>
  <li><a href="#machine-learninglinear-regression-first-results-wo-genre-variable" id="toc-machine-learninglinear-regression-first-results-wo-genre-variable" class="nav-link" data-scroll-target="#machine-learninglinear-regression-first-results-wo-genre-variable"> <span class="header-section-number">6.6</span> Machine Learning/Linear Regression (First Results w/o Genre Variable)</a></li>
  <li><a href="#split-the-data" id="toc-split-the-data" class="nav-link" data-scroll-target="#split-the-data"> <span class="header-section-number">6.7</span> Split the data</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"> <span class="header-section-number">6.8</span> Model specification</a></li>
  <li><a href="#check-correlation-between-specific-genres" id="toc-check-correlation-between-specific-genres" class="nav-link" data-scroll-target="#check-correlation-between-specific-genres"> <span class="header-section-number">6.9</span> Check correlation between specific genres</a></li>
  <li><a href="#fit-various-models-to-training-data-movie_training-evaluate-them-for-validation-data" id="toc-fit-various-models-to-training-data-movie_training-evaluate-them-for-validation-data" class="nav-link" data-scroll-target="#fit-various-models-to-training-data-movie_training-evaluate-them-for-validation-data"> <span class="header-section-number">6.10</span> Fit various models to training data (movie_training), evaluate them for validation data</a></li>
  <li><a href="#put-models-together" id="toc-put-models-together" class="nav-link" data-scroll-target="#put-models-together"> <span class="header-section-number">6.11</span> Put models together</a></li>
  <li><a href="#pull-out-metrics-for-comparison-and-more-wrangling" id="toc-pull-out-metrics-for-comparison-and-more-wrangling" class="nav-link" data-scroll-target="#pull-out-metrics-for-comparison-and-more-wrangling"> <span class="header-section-number">6.12</span> Pull out metrics for comparison and more wrangling</a></li>
  <li><a href="#use-model-on-testing-data" id="toc-use-model-on-testing-data" class="nav-link" data-scroll-target="#use-model-on-testing-data"> <span class="header-section-number">6.13</span> Use model on testing data</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="background-and-significance" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Background and Significance</h1>
<p>Cinema is a form of media that’s constantly reinventing itself, always exploring new genres and topics or even exploring older topics in a new form. The film industry is constantly looking at what makes a movie work, what makes it successful in a modern market; much analysis has been done on movie profit and other numerical variables, for example (Chen). As such, statistical analysis of the metadata behind the industry could prove to improve the development and financing process of creating a movie</p>
<p>The process of making a film, after the idea is already created, begins with a synopsis of the movie that’s then brought around by a lead producer to see if they can sell the idea. It’s only after this that funding can be acquired to actually produce the movie. Based on this short synopsis that presents the big ideas of the movie, the movie is evaluated, approved or denied for funding. Investors may be looking at what a “safe bet” for them is, what genre or buzzwords will get an audience excited to pay for a movie.</p>
<p>The aim of this study is to look at gross income as a response variable to a few explanatory variables. We will look at it as a response to the budget for the film, to the IMDB rating of the film, and to the duration. Within each of these relationships we will also look at which genres are associated with the gross income of the film, that is parsing out the individual contribution of a particular genre to how well the movie does at the box office. Going further, we will find out how accurately we can predict the gross income of the film factoring in its genre. A final research topic will explore the synergy between genres, looking at the difference between the gross income of films of one genre versus the gross income of films that incorporate multiple genres using the same numerical predictors.</p>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
<section id="data-collection" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-collection"><span class="header-section-number">2.1</span> Data Collection</h2>
<p>This dataset comes from Kaggle and was collected in 2016. We found that the gross income variable (gross) and the budget variable (budget) are measured in local currencies, and it is hard to convert them into USD, so we decided to only look at US movies in this project for homogeneity in currency.</p>
</section>
<section id="variable-creation" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="variable-creation"><span class="header-section-number">2.2</span> Variable Creation</h2>
<p>Some important variables in this dataset includes budget, gross income, genres, and IMDB scores, which are related to the budget of the movie, gross income of the movie, the genres of the movie, and its score on IMDB respectively. We also extract partial strings from the original “genres” variable to create individual genres dummy variable including comedy, family, action, horror, and etc.</p>
</section>
<section id="analytic-methods" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="analytic-methods"><span class="header-section-number">2.3</span> Analytic Methods</h2>
<p>We use machine learning, specifically multiple linear regression, to predict the gross income of a film using multiple predictors. Here, the response variable is gross income with predictors including IMDB score, movie genre, budget, and duration. We then move to use feature engineering in order to look at nonlinear correlations between the variables in the data set. We split the dataset using the validation set method and use these models created by feature engineering to predict the accuracy of our model for the testing data set. We set the null hypothesis to be that gross income is not correlated to any of the predictors the predictor set of variables.</p>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<p>In creating a correlation plot of all available variables, we visualize that some variables are strongly correlated with each other, causing a multicolliniarity. Therefore, we need to try out different models in order to solve this problems. In the 18 models that we created, Model 18 one turns out to have the best validation R-squared value of 0.53. Similarly, the R-squared for the entire training dataset is about 0.6 After verifying it with the testing dataset, we figure out that the R-squared value of Model 18 is 64%, which is decently good in predicting the gross income of a movie.</p>
<p>Among the variables, we find that actors’ facebook likes are highly correlated with one another. Additionally, budget of a movie and number of online reviews and users who voted for a movie is also highly correlated. Using multiple linear regression and looking at corresponding p-values for the genre coefficients, we found that on average and with a significance level of 0.05, the genres “Sci-Fi”, “Crime”, and “Fantasy” actually reduced the gross income of the movie. These coefficients were all negative and had respective p-values of 0.000035, 0.02, and 0.009. With this same method we found the variables “budget” and “num_voted_users” to positively contribute to gross income, with positive coefficients and respective p-values of approximately 0.</p>
</section>
<section id="discussionconclusions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion/Conclusions</h1>
<p>The objective of this study was to look at gross income as a response variable to the budget for the film, to the IMDB rating of the film, the duration of the film, and the genre tag of the film. The final model fit to this dataset incorporated these predictors, but used many more in addition to these initial predictors thought to be significant at the start of this project. Since the response variable in question was gross income, since the concern is just on how much the film makes from box office proceedings, the use of feature engineering was chosen to have the best predictive power for the training data, as well as the testing data. The only caveat to this process is that the specific sums and products used to create our final model (Model 18) are uninterpretable. However, since this feature engineering facilitated a more desirable R-squared value in our training and testing sets, this process was valid in our analysis of gross income.</p>
<p>Our p-value for Model 18, 1.98e-40 &lt;&lt; <span class="math inline">\(\alpha = 0.005\)</span>, suggests that this model is statistically significant, even though it only achieved a relatively low R-squared value of 0.641 (with an adjusted-R-squared value of 0.565). As prescribed by the p-value, we reject our null hypothesis that gross income is not correlated to any of the predictors the predictor set of variables with a p-value of 1.98e-40. However these results for correlation may be too low to be used in an investment setting, which may desire a much stronger correlation to ensure the most profit from their film. Still, all of this suggests that there is a relationship between the gross income of a film and the metadata included in our final model. Previous research consulted has reviewed individual metadata and their correlation to the revenue of the films in their data, but they didn’t use multiple predictors or feature engineering, an expansion that this project attempts to provide. Our results suggest that this approach, using many predictors, including qualitative information like film genre, to predict gross income, can go further in the film industry. Despite the fact that much of the “buzz” surrounding the film industry and the films they produce appears to be qualitative, it is possible to examine it in a quantitative sense using multiple linear regression modeling. If this process were continued with more data, with a greater focus on metadata on each film, possible investors could be given predictions based on preliminary information on a film and make an informed decision to fund a project.</p>
<p><span class="citation" data-cites="wickham2019">[<a href="#ref-wickham2019" role="doc-biblioref">1</a>]</span>, <span class="citation" data-cites="couch2021">[<a href="#ref-couch2021" role="doc-biblioref">2</a>]</span>, <span class="citation" data-cites="rstudioapi">[<a href="#ref-rstudioapi" role="doc-biblioref">3</a>]</span>, <span class="citation" data-cites="tidyverse">[<a href="#ref-tidyverse" role="doc-biblioref">4</a>]</span>, <span class="citation" data-cites="tidymodels">[<a href="#ref-tidymodels" role="doc-biblioref">5</a>]</span>, <span class="citation" data-cites="infer">[<a href="#ref-infer" role="doc-biblioref">6</a>]</span>, <span class="citation" data-cites="GGally">[<a href="#ref-GGally" role="doc-biblioref">7</a>]</span>, <span class="citation" data-cites="ggfortify">[<a href="#ref-ggfortify" role="doc-biblioref">8</a>]</span>, <span class="citation" data-cites="knitr">[<a href="#ref-knitr" role="doc-biblioref">9</a>]</span>, <span class="citation" data-cites="corrplot">[<a href="#ref-corrplot" role="doc-biblioref">10</a>]</span>, <span class="citation" data-cites="chen2018">[<a href="#ref-chen2018" role="doc-biblioref">11</a>]</span>, <span class="citation" data-cites="james2013">[<a href="#ref-james2013" role="doc-biblioref">12</a>]</span></p>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References:</h1>
<div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-wickham2019" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span class="smallcaps">Wickham</span>, H., <span class="smallcaps">Averick</span>, M., <span class="smallcaps">Bryan</span>, J., <span class="smallcaps">Chang</span>, W., <span class="smallcaps">McGowan</span>, L., <span class="smallcaps">François</span>, R., <span class="smallcaps">Grolemund</span>, G., <span class="smallcaps">Hayes</span>, A., <span class="smallcaps">Henry</span>, L., <span class="smallcaps">Hester</span>, J., <span class="smallcaps">Kuhn</span>, M., <span class="smallcaps">Pedersen</span>, T., <span class="smallcaps">Miller</span>, E., <span class="smallcaps">Bache</span>, S., <span class="smallcaps">Müller</span>, K., <span class="smallcaps">Ooms</span>, J., <span class="smallcaps">Robinson</span>, D., <span class="smallcaps">Seidel</span>, D., <span class="smallcaps">Spinu</span>, V., <span class="smallcaps">Takahashi</span>, K., <span class="smallcaps">Vaughan</span>, D., <span class="smallcaps">Wilke</span>, C., <span class="smallcaps">Woo</span>, K. and <span class="smallcaps">Yutani</span>, H. (2019). <a href="https://doi.org/10.21105/joss.01686">Welcome to the tidyverse</a>. <em>Journal of Open Source Software</em> <strong>4</strong> 1686.</div>
</div>
<div id="ref-couch2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline"><span class="smallcaps">Couch</span>, S., <span class="smallcaps">Bray</span>, A., <span class="smallcaps">Ismay</span>, C., <span class="smallcaps">Chasnovski</span>, E., <span class="smallcaps">Baumer</span>, B. and <span class="smallcaps">Çetinkaya-Rundel</span>, M. (2021). <a href="https://doi.org/10.21105/joss.03661">Infer: An r package for tidyverse-friendly statistical inference</a>. <em>Journal of Open Source Software</em> <strong>6</strong> 3661.</div>
</div>
<div id="ref-rstudioapi" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline"><span class="smallcaps">Ushey</span>, K., <span class="smallcaps">Allaire</span>, J., <span class="smallcaps">Wickham</span>, H. and <span class="smallcaps">Ritchie</span>, G. (2022). <a href="https://CRAN.R-project.org/package=rstudioapi">Rstudioapi: Safely access the RStudio API</a>.</div>
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline"><span class="smallcaps">Wickham</span>, H., <span class="smallcaps">Averick</span>, M., <span class="smallcaps">Bryan</span>, J., <span class="smallcaps">Chang</span>, W., <span class="smallcaps">McGowan</span>, L. D., <span class="smallcaps">François</span>, R., <span class="smallcaps">Grolemund</span>, G., <span class="smallcaps">Hayes</span>, A., <span class="smallcaps">Henry</span>, L., <span class="smallcaps">Hester</span>, J., <span class="smallcaps">Kuhn</span>, M., <span class="smallcaps">Pedersen</span>, T. L., <span class="smallcaps">Miller</span>, E., <span class="smallcaps">Bache</span>, S. M., <span class="smallcaps">Müller</span>, K., <span class="smallcaps">Ooms</span>, J., <span class="smallcaps">Robinson</span>, D., <span class="smallcaps">Seidel</span>, D. P., <span class="smallcaps">Spinu</span>, V., <span class="smallcaps">Takahashi</span>, K., <span class="smallcaps">Vaughan</span>, D., <span class="smallcaps">Wilke</span>, C., <span class="smallcaps">Woo</span>, K. and <span class="smallcaps">Yutani</span>, H. (2019). <a href="https://doi.org/10.21105/joss.01686">Welcome to the <span></span>tidyverse<span></span></a>. <strong>4</strong> 1686.</div>
</div>
<div id="ref-tidymodels" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline"><span class="smallcaps">Kuhn</span>, M. and <span class="smallcaps">Wickham</span>, H. (2020). <a href="https://www.tidymodels.org">Tidymodels: A collection of packages for modeling and machine learning using tidyverse principles.</a></div>
</div>
<div id="ref-infer" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline"><span class="smallcaps">Couch</span>, S. P., <span class="smallcaps">Bray</span>, A. P., <span class="smallcaps">Ismay</span>, C., <span class="smallcaps">Chasnovski</span>, E., <span class="smallcaps">Baumer</span>, B. S. and <span class="smallcaps">Çetinkaya-Rundel</span>, M. (2021). <a href="https://doi.org/10.21105/joss.03661"><span></span>Infer<span></span>: An <span></span>r<span></span> package for tidyverse-friendly statistical inference</a>. <strong>6</strong> 3661.</div>
</div>
<div id="ref-GGally" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline"><span class="smallcaps">Schloerke</span>, B., <span class="smallcaps">Cook</span>, D., <span class="smallcaps">Larmarange</span>, J., <span class="smallcaps">Briatte</span>, F., <span class="smallcaps">Marbach</span>, M., <span class="smallcaps">Thoen</span>, E., <span class="smallcaps">Elberg</span>, A. and <span class="smallcaps">Crowley</span>, J. (2021). <a href="https://CRAN.R-project.org/package=GGally">GGally: Extension to ’ggplot2’</a>.</div>
</div>
<div id="ref-ggfortify" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline"><span class="smallcaps">Tang</span>, Y., <span class="smallcaps">Horikoshi</span>, M. and <span class="smallcaps">Li</span>, W. (2016). <a href="https://doi.org/10.32614/RJ-2016-060">Ggfortify: Unified interface to visualize statistical result of popular r packages</a>. <strong>8</strong>.</div>
</div>
<div id="ref-knitr" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline"><span class="smallcaps">Xie</span>, Y. (2022). <a href="https://yihui.org/knitr/">Knitr: A general-purpose package for dynamic report generation in r</a>.</div>
</div>
<div id="ref-corrplot" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline"><span class="smallcaps">Wei</span>, T. and <span class="smallcaps">Simko</span>, V. (2021). <a href="https://github.com/taiyun/corrplot">R package ’corrplot’: Visualization of a correlation matrix</a>.</div>
</div>
<div id="ref-chen2018" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline"><span class="smallcaps">Chen</span>, A. W. (2018). <a href="http://www.ijbmer.com/docs/volumes/vol9issue3/ijbmer2018090303.pdf">A statistical analysis of gross revenue in movie industry</a>.</div>
</div>
<div id="ref-james2013" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline"><span class="smallcaps">James</span>, G., <span class="smallcaps">Witten</span>, D., <span class="smallcaps">Hastie</span>, T. and <span class="smallcaps">Tibshirani</span>, R. (2013). <em><a href="https://doi.org/10.1007/978-1-4614-7138-7">An introduction to statistical learning</a></em>. Springer New York.</div>
</div>
</div>
</section>
<section id="appendix" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Appendix</h1>
<section id="libraries" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="libraries"><span class="header-section-number">6.1</span> Libraries</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-1_d60007359c5aaf170506e3dc4f947520">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy.opts=</span><span class="fu">list</span>(<span class="at">width.cutoff=</span><span class="dv">60</span>),<span class="at">tidy=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="dataset"><span class="header-section-number">6.2</span> Dataset</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-2_70839313600d5ac4acf416f1627b126f">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># movie_raw_data &lt;- read_csv('movie_metadata.csv')</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>movie_raw_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/turalsadigov/MATH_254/main/Datasets%20for%20projects/movie_metadata_trevor_raio.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="table-of-variables-in-dataset" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="table-of-variables-in-dataset"><span class="header-section-number">6.3</span> Table of Variables in Dataset</h2>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 3%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th></th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>color</strong></td>
<td></td>
<td>is the movie colored or black and white?</td>
</tr>
<tr class="even">
<td><p><strong>num_critic_</strong></p>
<p><strong>for_reviews</strong></p></td>
<td></td>
<td>number of critics for reviews on IMDB</td>
</tr>
<tr class="odd">
<td><strong>duration</strong></td>
<td></td>
<td>the movie duration</td>
</tr>
<tr class="even">
<td><strong>director_facebook_likes</strong></td>
<td></td>
<td>number of likes that the director get on facebook (0s are missing data)</td>
</tr>
<tr class="odd">
<td><strong>actor_1_facebook_likes</strong></td>
<td></td>
<td>number of likes that the actor with most likes have on facebook (0s are missing data)</td>
</tr>
<tr class="even">
<td><strong>actor_2_facebook_likes</strong></td>
<td></td>
<td>number of likes that the actor with second most likes have on facebook (0s are missing data)</td>
</tr>
<tr class="odd">
<td><strong>actor_3_facebook_likes</strong></td>
<td></td>
<td>number of likes that the actor with third most likes have on facebook (0s are missing data)</td>
</tr>
<tr class="even">
<td><strong>cast_total_facebook_likes</strong></td>
<td></td>
<td>number of the total facebook likes of the casts</td>
</tr>
<tr class="odd">
<td><strong>gross</strong></td>
<td></td>
<td>gross income of the movie</td>
</tr>
<tr class="even">
<td><strong>genres</strong></td>
<td></td>
<td>the genres of the movie (there maybe multiple genres for one movie)</td>
</tr>
<tr class="odd">
<td><strong>num_voted_users</strong></td>
<td></td>
<td>number of users that voted on IMDB</td>
</tr>
<tr class="even">
<td><strong>facenumber_in_poster</strong></td>
<td></td>
<td>number of faces in the poster</td>
</tr>
<tr class="odd">
<td><strong>num_user_for_reviews</strong></td>
<td></td>
<td>number of users for reviews on IMDB</td>
</tr>
<tr class="even">
<td><strong>content_rating</strong></td>
<td></td>
<td>the content rating of the movie</td>
</tr>
<tr class="odd">
<td><strong>budget</strong></td>
<td></td>
<td>the budget of the movie</td>
</tr>
<tr class="even">
<td><strong>title_year</strong></td>
<td></td>
<td>the year that the movie was published</td>
</tr>
<tr class="odd">
<td><strong>imdb_scores</strong></td>
<td></td>
<td>the IMDB scores of the movies</td>
</tr>
<tr class="even">
<td><strong>aspect_ratio</strong></td>
<td></td>
<td>aspect ratio of the movie</td>
</tr>
<tr class="odd">
<td><strong>movie_facebook_likes</strong></td>
<td></td>
<td>number of likes that the movie got on facebook</td>
</tr>
</tbody>
</table>
</section>
<section id="cleaning" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="cleaning"><span class="header-section-number">6.4</span> Cleaning</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-3_98ca4d572d62a80ee70e5869fde9e711">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set so that long lines in R will be wrapped:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy.opts=</span><span class="fu">list</span>(<span class="at">width.cutoff=</span><span class="dv">80</span>), <span class="at">tidy=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This part clears the outliers and focuses on the main part of the data by </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># excluding the lowest 5% and the highest 5% of the data in each variable</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a range for each variable that excludes the lowest and highest 5%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For each variable, we find the cut-off points for the</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># lowest 5% and the highest 5%.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>num_critic_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>num_critic_for_reviews, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">na.rm =</span> T)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>num_voted_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>num_voted_users, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.rm =</span> T)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>budget_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>budget, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">na.rm =</span> T)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>duration_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>duration, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">na.rm =</span> T)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>gross_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>gross, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">na.rm =</span> T)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>actor_1_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>actor_1_facebook_likes, </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.rm =</span> T)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>actor_2_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>actor_2_facebook_likes, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.rm =</span> T)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>actor_3_quartile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(movie_raw_data<span class="sc">$</span>actor_3_facebook_likes, </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">na.rm =</span> T)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Dropping data that isn't in the ranges/dropping unwanted variables</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the cut-off points that we identified above, and include the data points</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># that are only within the lower and higher boundaries.</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>movie_data <span class="ot">&lt;-</span> movie_raw_data <span class="sc">%&gt;%</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">'USA'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(budget_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> budget <span class="sc">&amp;</span> budget <span class="sc">&lt;</span> budget_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(duration_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> duration <span class="sc">&amp;</span> duration <span class="sc">&lt;</span> duration_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gross_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> gross <span class="sc">&amp;</span> gross <span class="sc">&lt;</span> gross_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(actor_1_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> actor_1_facebook_likes <span class="sc">&amp;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>           actor_1_facebook_likes <span class="sc">&lt;</span> actor_1_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(actor_2_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> actor_2_facebook_likes <span class="sc">&amp;</span> </span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>           actor_2_facebook_likes <span class="sc">&lt;</span> actor_2_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(actor_3_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> actor_3_facebook_likes <span class="sc">&amp;</span> </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>           actor_3_facebook_likes <span class="sc">&lt;</span> actor_3_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_critic_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> num_critic_for_reviews <span class="sc">&amp;</span> </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>           num_critic_for_reviews <span class="sc">&lt;</span> num_critic_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_voted_quartile[<span class="dv">1</span>] <span class="sc">&lt;</span> num_voted_users </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>         <span class="sc">&amp;</span> num_voted_users <span class="sc">&lt;</span> num_voted_quartile[<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">22</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preliminary-visualizations" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="preliminary-visualizations"><span class="header-section-number">6.5</span> Preliminary Visualizations</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-4_37f991c5ed66aa79679f63a867256096">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(duration, imdb_score) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> num_voted_users, <span class="at">y =</span> imdb_score)) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Movie Duration"</span>, <span class="at">y =</span> <span class="st">'IMDB Scores'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-5_1198a6a876730c78e9d0d3592f3e86e6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(duration, imdb_score) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> duration, <span class="at">y =</span> imdb_score)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>( <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Movie Duration"</span>, <span class="at">y =</span> <span class="st">'IMDB Scores'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-6_cf982d0ef82947f30b4ba7374b401ef0">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gross, imdb_score) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gross, <span class="at">y =</span> imdb_score)) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gross Income"</span>, <span class="at">y =</span> <span class="st">'IMDB Scores'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-7_151b1c3e2a4eb907eb5647a050bd2065">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(imdb_score, budget) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> budget, <span class="at">y =</span> imdb_score)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Budget"</span>, <span class="at">y =</span> <span class="st">'IMDB Scores'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="machine-learninglinear-regression-first-results-wo-genre-variable" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="machine-learninglinear-regression-first-results-wo-genre-variable"><span class="header-section-number">6.6</span> Machine Learning/Linear Regression (First Results w/o Genre Variable)</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-8_da4570c98e1dde8c5310795c9ddec3d1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'lm'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">'regression'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(gross <span class="sc">~</span> duration<span class="sc">+</span>imdb_score<span class="sc">+</span>budget, <span class="at">data =</span> movie_data)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term             estimate    std.error statistic   p.value
  &lt;chr&gt;               &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) -24553547.    6203526.        -3.96  7.83e-  5
2 duration         8531.      59170.         0.144 8.85e-  1
3 imdb_score    6703840.     804554.         8.33  1.49e- 16
4 budget              0.745       0.0299    25.0   2.40e-119</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r…¹  sigma stati…²   p.value    df  logLik    AIC    BIC devia…³
      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     0.277   0.276 3.22e7    245. 1.32e-134     3 -35917. 71844. 71872. 1.99e18
# … with 2 more variables: df.residual &lt;int&gt;, nobs &lt;int&gt;, and abbreviated
#   variable names ¹​adj.r.squared, ²​statistic, ³​deviance</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> movie_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,920 × 1
        .pred
        &lt;dbl&gt;
 1  91632317.
 2 101189775.
 3 114739888.
 4  95973049.
 5 108388825.
 6  75130273.
 7  83907909.
 8  94472848.
 9  93332847.
10  99756214.
# … with 1,910 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(model_1, <span class="at">new_data =</span> movie_data)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> gross)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(duration, imdb_score, budget, gross) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(model_1, <span class="at">new_data =</span> movie_data)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ress =</span> gross <span class="sc">-</span> .pred, <span class="at">ress_sq =</span> ress<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RSS =</span> <span class="fu">sum</span>(ress_sq), </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">TSS =</span> <span class="fu">sum</span>((gross <span class="sc">-</span> <span class="fu">mean</span>(gross))<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">perc_not_explained =</span> RSS<span class="sc">/</span>TSS,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">R_sq =</span> <span class="dv">1</span> <span class="sc">-</span> perc_not_explained,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">r =</span> <span class="fu">cor</span>(gross, .pred),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">r_sq =</span> r<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      RSS     TSS perc_not_explained  R_sq     r  r_sq
    &lt;dbl&gt;   &lt;dbl&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1.99e18 2.76e18              0.723 0.277 0.527 0.277</code></pre>
</div>
</div>
</section>
<section id="split-the-data" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="split-the-data"><span class="header-section-number">6.7</span> Split the data</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-9_5e5741b94001e12252cbfaab6fded8bc">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>movie_data_test <span class="ot">&lt;-</span> movie_data</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>comedy <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Comedy'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>crime <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Crime'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>action <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Action'</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>mystery <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Mystery'</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>adventure <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Adventure'</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>animation <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Animation'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>family <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Family'</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>musical <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Musical'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>sci_fi <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Sci-Fi'</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'History'</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>thriller <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Thriller'</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>romance <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Romance'</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>sport <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Sport'</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>horror <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Horror'</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>war <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'War'</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>fantasy <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Fantasy'</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>western <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Western'</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>biography <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'Biography'</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>music <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(movie_data<span class="sc">$</span>genres, <span class="st">'music'</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>movie_data_test <span class="ot">&lt;-</span> movie_data <span class="sc">%&gt;%</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(genres, <span class="at">.after =</span> movie_facebook_likes) <span class="sc">%&gt;%</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">comedy =</span> comedy) <span class="sc">%&gt;%</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">crime =</span> crime) <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">action =</span> action) <span class="sc">%&gt;%</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">mystery =</span> mystery) <span class="sc">%&gt;%</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">adventure =</span> adventure) <span class="sc">%&gt;%</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">animation =</span> animation) <span class="sc">%&gt;%</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">family =</span> family) <span class="sc">%&gt;%</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">musical =</span> musical) <span class="sc">%&gt;%</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">sci_fi =</span> sci_fi) <span class="sc">%&gt;%</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">history =</span> history) <span class="sc">%&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">thriller =</span> thriller) <span class="sc">%&gt;%</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">romance =</span> romance) <span class="sc">%&gt;%</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">sport =</span> sport) <span class="sc">%&gt;%</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">horror =</span> horror) <span class="sc">%&gt;%</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">war =</span> war) <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">fantasy =</span> fantasy) <span class="sc">%&gt;%</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">western =</span> western) <span class="sc">%&gt;%</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">biography =</span> biography) <span class="sc">%&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">music =</span> music)  </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">47</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>movie_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(<span class="at">data =</span> movie_data_test, <span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">strata =</span> gross)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>movie_training <span class="ot">&lt;-</span> <span class="fu">training</span>(movie_split)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>movie_testing <span class="ot">&lt;-</span> <span class="fu">testing</span>(movie_split)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>movie_validation_resample <span class="ot">&lt;-</span> <span class="fu">validation_split</span>(<span class="at">data =</span> movie_training,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">prop =</span> <span class="fl">0.75</span>,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">strata =</span> gross)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-specification" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="model-specification"><span class="header-section-number">6.8</span> Model specification</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-10_9d58e68fd862e2855be3d5bc6dcf55a6">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lm_specs <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'lm'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">'regression'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-correlation-between-specific-genres" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="check-correlation-between-specific-genres"><span class="header-section-number">6.9</span> Check correlation between specific genres</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-11_2370fcdeeddbb0b488e1fb6244d9cd78">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cor_variable <span class="ot">&lt;-</span> movie_data_test <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>color, <span class="sc">-</span> genres, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">37</span>), <span class="sc">-</span> aspect_ratio, <span class="sc">-</span>facenumber_in_poster) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_variable, <span class="at">method =</span> <span class="st">'pie'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cor_genres <span class="ot">&lt;-</span> movie_data_test <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gross, budget, <span class="fu">c</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">37</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_genres, <span class="at">method =</span> <span class="st">'pie'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="movie_profit_prediction_model_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fit-various-models-to-training-data-movie_training-evaluate-them-for-validation-data" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="fit-various-models-to-training-data-movie_training-evaluate-them-for-validation-data"><span class="header-section-number">6.10</span> Fit various models to training data (movie_training), evaluate them for validation data</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-12_d9e5d437b253d6608ee7a058d0d42fb5">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy.opts=</span><span class="fu">list</span>(<span class="at">width.cutoff=</span><span class="dv">80</span>), <span class="at">tidy=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. <span class="sc">-</span>genres,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> duration,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>model_4 <span class="ot">&lt;-</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> facenumber_in_poster,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>model_5 <span class="ot">&lt;-</span> </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>model_6 <span class="ot">&lt;-</span> </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews,</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>model_7 <span class="ot">&lt;-</span> </span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews </span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> director_facebook_likes,</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>model_8 <span class="ot">&lt;-</span> </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews </span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> cast_total_facebook_likes,</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>model_9 <span class="ot">&lt;-</span> </span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews </span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> title_year,</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>model_10 <span class="ot">&lt;-</span> </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews </span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_3_facebook_likes,</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>model_11 <span class="ot">&lt;-</span> </span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio </span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> actor_3_facebook_likes<span class="sc">*</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>                  actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>                  actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>                  cast_total_facebook_likes,</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>model_12 <span class="ot">&lt;-</span> </span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews </span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> movie_facebook_likes,</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>model_13 <span class="ot">&lt;-</span> </span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres</span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio</span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> movie_facebook_likes</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> imdb_score<span class="sc">*</span>budget<span class="sc">*</span>duration<span class="sc">*</span><span class="fu">log</span>(num_user_for_reviews),</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>model_14 <span class="ot">&lt;-</span> </span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> color </span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> aspect_ratio</span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> movie_facebook_likes</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_critic_for_reviews</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> imdb_score<span class="sc">*</span>budget<span class="sc">*</span>duration<span class="sc">*</span>num_voted_users,</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>model_15 <span class="ot">&lt;-</span> </span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_1_facebook_likes</span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_2_facebook_likes</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_3_facebook_likes</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> cast_total_facebook_likes</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>                  actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>                  actor_3_facebook_likes<span class="sc">*</span></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>                  cast_total_facebook_likes,</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>model_16 <span class="ot">&lt;-</span> </span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span>. </span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> genres </span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_1_facebook_likes</span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_2_facebook_likes </span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> actor_3_facebook_likes </span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> cast_total_facebook_likes </span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>                  actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>                  actor_3_facebook_likes<span class="sc">*</span></span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>                  cast_total_facebook_likes </span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_critic_for_reviews </span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_voted_users</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> num_user_for_reviews</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> title_year </span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span> movie_facebook_likes </span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> num_critic_for_reviews<span class="sc">*</span></span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a>                  num_voted_users<span class="sc">*</span></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>                  num_user_for_reviews<span class="sc">*</span></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>                  title_year<span class="sc">*</span></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>                  movie_facebook_likes,</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>model_17 <span class="ot">&lt;-</span> </span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span> actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a>                        actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>                        cast_total_facebook_likes </span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> num_critic_for_reviews<span class="sc">*</span></span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>                  num_voted_users<span class="sc">*</span></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>                  num_user_for_reviews<span class="sc">*</span></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>                  movie_facebook_likes </span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> budget</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> facenumber_in_poster</span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> title_year</span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> imdb_score<span class="sc">*</span>num_voted_users<span class="sc">*</span>duration</span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> family </span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> animation </span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> comedy </span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> horror </span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> sci_fi </span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> thriller </span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> sport </span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> mystery </span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> fantasy,</span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a>model_18 <span class="ot">&lt;-</span> </span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(gross <span class="sc">~</span> actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>                        actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>                        cast_total_facebook_likes</span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> num_critic_for_reviews<span class="sc">*</span></span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>                  num_voted_users<span class="sc">*</span></span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>                  num_user_for_reviews<span class="sc">*</span></span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>                  movie_facebook_likes<span class="sc">*</span></span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a>                  budget</span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> facenumber_in_poster</span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> director_facebook_likes</span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> title_year<span class="sc">*</span>num_critic_for_reviews</span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> imdb_score<span class="sc">*</span>duration</span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> family </span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> animation </span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> comedy<span class="sc">*</span>crime<span class="sc">*</span>action<span class="sc">*</span>thriller </span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> horror </span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> sci_fi </span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> sport </span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> mystery </span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> fantasy,</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>                movie_validation_resample,</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>                <span class="at">metrics =</span> <span class="fu">metric_set</span>(rsq, rmse, mae))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="put-models-together" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="put-models-together"><span class="header-section-number">6.11</span> Put models together</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-13_1dc25d845264311564d88a24600d6f94">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy.opts=</span><span class="fu">list</span>(<span class="at">width.cutoff=</span><span class="dv">80</span>), <span class="at">tidy=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>fitted_models <span class="ot">&lt;-</span> <span class="fu">list</span>(model_1, model_2, model_3, model_4, model_5, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                      model_6,model_7, model_8, model_9, model_10, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                      model_11, model_12, model_13, model_14, model_15, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                      model_16, model_17, model_18)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pull-out-metrics-for-comparison-and-more-wrangling" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="pull-out-metrics-for-comparison-and-more-wrangling"><span class="header-section-number">6.12</span> Pull out metrics for comparison and more wrangling</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-14_867776db6ff803b53c46564df1e8f706">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>validation_result <span class="ot">&lt;-</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fitted_models) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_name =</span> <span class="fu">row_number</span>())</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>model_results <span class="ot">&lt;-</span> validation_result <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.metrics, model_name) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics)<span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.metric, .estimate, model_name) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(.metric) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> .estimate)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>model_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 4
   model_name       mae      rmse   rsq
        &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1          1 22118371. 30397946. 0.425
 2          2 22011222. 30247805. 0.431
 3          3 22133173. 30437255. 0.424
 4          4 22066000. 30296562. 0.429
 5          5 21971880. 30190439. 0.431
 6          6 21958166. 30166740. 0.432
 7          7 22048232. 30361787. 0.425
 8          8 22162076. 30296129. 0.427
 9          9 22231022. 30426357. 0.423
10         10 22006311. 30179184. 0.431
11         11 22016584. 30275333. 0.427
12         12 21962503. 30105552. 0.434
13         13 21284147. 29313708. 0.463
14         14 20291532. 27824589. 0.514
15         15 22143616. 30499703. 0.421
16         16 20757730. 29392687. 0.463
17         17 19700015. 27234895. 0.533
18         18 19914855. 27205015. 0.534</code></pre>
</div>
</div>
</section>
<section id="use-model-on-testing-data" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="use-model-on-testing-data"><span class="header-section-number">6.13</span> Use model on testing data</h2>
<div class="cell" data-hash="movie_profit_prediction_model_cache/html/unnamed-chunk-15_f0cc9cd05971b20070bdef8291fbc85e">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  lm_specs <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(gross <span class="sc">~</span> actor_1_facebook_likes<span class="sc">*</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>              actor_2_facebook_likes<span class="sc">*</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>              cast_total_facebook_likes </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> num_critic_for_reviews<span class="sc">*</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        num_voted_users<span class="sc">*</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        num_user_for_reviews<span class="sc">*</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        movie_facebook_likes<span class="sc">*</span>budget</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> facenumber_in_poster</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> director_facebook_likes</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> title_year<span class="sc">*</span>num_critic_for_reviews</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> imdb_score<span class="sc">*</span>duration</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> family </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> animation </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> comedy<span class="sc">*</span>crime<span class="sc">*</span>action<span class="sc">*</span>thriller </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> horror </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> sci_fi </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> sport </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> mystery </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> fantasy,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> movie_testing)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.s…¹  sigma stati…²  p.value    df logLik    AIC    BIC devia…³
      &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     0.641     0.565 2.42e7    8.40 1.98e-40    67 -7018. 14174. 14446. 1.85e17
# … with 2 more variables: df.residual &lt;int&gt;, nobs &lt;int&gt;, and abbreviated
#   variable names ¹​adj.r.squared, ²​statistic, ³​deviance</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>